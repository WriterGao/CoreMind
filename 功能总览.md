# CoreMind AI助手平台 - 功能总览

## 项目简介

CoreMind是一个企业级的AI助手平台，支持自定义数据源、知识库、接口和LLM配置，让用户能够构建专属的智能对话系统。

## 核心功能模块

### 1. 🤖 LLM模型配置

**功能**：管理多种大语言模型的配置

**特性**：
- ✅ 支持10+主流LLM提供商
  - OpenAI (GPT-3.5/4/o1)
  - Azure OpenAI
  - DeepSeek
  - 阿里云通义千问
  - 智谱AI (ChatGLM)
  - 百度文心一言
  - 月之暗面 (Kimi)
  - Anthropic (Claude)
  - Google Gemini
  - Ollama (本地部署)
  - 自定义模型
- ✅ 手动输入模型名称支持
- ✅ API密钥安全管理
- ✅ 参数精细调节（温度、最大Token）
- ✅ 默认配置设置
- ✅ 配置启用/禁用

**页面路径**：`/llm-configs`

**使用场景**：
```
场景1：配置OpenAI GPT-4用于复杂推理
场景2：配置DeepSeek用于代码生成
场景3：配置本地Ollama模型保护数据隐私
场景4：配置通义千问用于中文优化场景
```

---

### 2. 🎭 AI助手配置

**功能**：创建和管理AI助手的能力组合

**特性**：
- ✅ 选择LLM模型
- ✅ 自定义系统提示词
- ✅ 知识库范围选择
- ✅ 数据源权限配置
- ✅ 接口调用权限
- ✅ 智能路由开关
- ✅ 多助手管理
- ✅ 默认助手设置

**页面路径**：`/assistants`

**使用场景**：
```
助手1：技术支持助手
  - LLM: GPT-4
  - 知识库: 产品文档 + API文档
  - 数据源: 工单数据库
  - 接口: 创建工单、发送通知
  - 智能路由: 启用

助手2：数据分析助手
  - LLM: DeepSeek
  - 知识库: 无
  - 数据源: 业务数据库 + 数据仓库
  - 接口: 生成报表、发送邮件
  - 智能路由: 启用

助手3：客服助手
  - LLM: 通义千问
  - 知识库: FAQ + 产品手册
  - 数据源: 用户数据库
  - 接口: 无
  - 智能路由: 启用
```

---

### 3. 💬 智能对话

**功能**：基于助手配置的对话系统

**特性**：
- ✅ 选择助手创建对话
- ✅ 多对话管理
- ✅ 实时消息收发
- ✅ 对话历史保存
- ✅ Markdown格式支持
- ✅ 对话切换
- ✅ 对话删除

**页面路径**：`/chat`

**工作流程**：
```
1. 用户创建对话
   ↓
2. 选择AI助手（自动加载配置）
   ↓
3. 发送消息
   ↓
4. 智能路由分析（如果启用）
   ├─ 需要知识库？→ 检索文档
   ├─ 需要查数据？→ 查询数据库
   ├─ 需要操作？→ 调用接口
   └─ 直接回答？→ 调用LLM
   ↓
5. 生成并返回回复
```

**当前状态**：
- ✅ 基础框架完成
- ✅ 助手配置集成
- 🔄 LLM调用（开发中）
- 🔄 智能路由（开发中）
- 🔄 工具调用（开发中）

---

### 4. 📚 知识库管理

**功能**：构建和管理向量知识库

**特性**：
- ✅ 多知识库支持
- ✅ 文档上传
- ✅ 向量化存储
- ✅ 语义搜索
- ✅ 文档管理
- ✅ 版本控制

**页面路径**：`/knowledge`

**支持的文档类型**：
- PDF
- Word (docx)
- TXT
- Markdown
- HTML

**使用场景**：
```
场景1：技术文档知识库
  - 产品手册
  - API文档
  - 开发指南

场景2：企业知识库
  - 内部规章制度
  - 工作流程文档
  - 培训资料

场景3：客服FAQ
  - 常见问题
  - 解决方案
  - 产品说明
```

---

### 5. 🗄️ 数据源管理

**功能**：连接和管理外部数据源

**特性**：
- ✅ 多种数据源类型
  - 本地文件
  - MySQL
  - PostgreSQL
  - MongoDB
  - REST API
  - 云存储
  - Web爬虫
- ✅ 使用规范文档
- ✅ 结构信息配置
- ✅ 使用示例
- ✅ 同步管理
- ✅ 详情查看

**页面路径**：`/datasources`

**配置示例**：
```yaml
数据源：业务数据库
类型：PostgreSQL
配置：
  host: db.example.com
  port: 5432
  database: business
  user: app_user
使用规范：
  本数据库包含用户信息和订单数据。
  - users表：用户基本信息
  - orders表：订单详情
  - 注意：查询时限制返回行数
结构信息：
  tables:
    - name: users
      columns:
        - name: id, type: uuid
        - name: username, type: varchar
    - name: orders
      columns:
        - name: id, type: uuid
        - name: user_id, type: uuid
        - name: amount, type: decimal
示例：
  - description: "查询今日订单总数"
    query: "SELECT COUNT(*) FROM orders WHERE DATE(created_at) = CURRENT_DATE"
```

---

### 6. 🔌 接口管理

**功能**：定义和管理自定义接口

**特性**：
- ✅ 多种接口类型
  - 内部函数
  - 外部API
  - 数据库操作
  - 文件处理
- ✅ 参数定义
- ✅ 响应schema
- ✅ 接口测试
- ✅ 接口执行

**页面路径**：`/interfaces`

**接口示例**：
```yaml
接口：发送邮件通知
类型：外部API
URL：https://api.email.com/send
方法：POST
参数：
  - to: string (必填)
  - subject: string (必填)
  - content: string (必填)
响应：
  success: boolean
  message_id: string
```

---

### 7. 🔐 用户认证

**功能**：用户注册、登录和权限管理

**特性**：
- ✅ 用户注册
- ✅ 用户登录
- ✅ JWT令牌认证
- ✅ 密码加密（bcrypt）
- ✅ 会话管理
- ✅ 自动登出

**页面路径**：`/login`, `/register`

---

## 系统架构

### 技术栈

**前端**：
- React 18
- TypeScript
- Vite
- Ant Design
- Zustand (状态管理)
- Axios

**后端**：
- Python 3.11
- FastAPI
- SQLAlchemy (ORM)
- PostgreSQL (主数据库)
- Redis (缓存)
- ChromaDB (向量数据库)

**部署**：
- Docker
- Docker Compose
- Nginx

### 架构图

```
┌─────────────────────────────────────────────┐
│            前端 (React + TS)                 │
│  ┌──────────┬──────────┬─────────────────┐  │
│  │ LLM配置  │ 助手配置  │ 对话界面        │  │
│  ├──────────┼──────────┼─────────────────┤  │
│  │ 知识库   │ 数据源   │ 接口管理        │  │
│  └──────────┴──────────┴─────────────────┘  │
└──────────────────┬──────────────────────────┘
                   │ REST API
┌──────────────────▼──────────────────────────┐
│         后端 (FastAPI + Python)              │
│  ┌──────────────────────────────────────┐   │
│  │         API路由层                     │   │
│  │  /llm-configs  /assistants  /chat-v2 │   │
│  └────────────┬──────────────────────────┘   │
│  ┌────────────▼──────────────────────────┐   │
│  │         业务逻辑层                     │   │
│  │  LLM服务  智能路由  工具调用          │   │
│  └────────────┬──────────────────────────┘   │
│  ┌────────────▼──────────────────────────┐   │
│  │         数据访问层                     │   │
│  │  SQLAlchemy ORM  异步数据库操作       │   │
│  └────────────┬──────────────────────────┘   │
└───────────────┼──────────────────────────────┘
                │
┌───────────────▼──────────────────────────────┐
│            数据层                             │
│  ┌──────────┬──────────┬──────────────────┐  │
│  │PostgreSQL│  Redis   │   ChromaDB       │  │
│  │(主数据库)│  (缓存)  │  (向量数据库)    │  │
│  └──────────┴──────────┴──────────────────┘  │
└───────────────────────────────────────────────┘
```

---

## 数据模型

### 核心表结构

```
users (用户表)
├── id: UUID
├── username: string
├── email: string
├── password_hash: string
└── created_at: datetime

llm_configs (LLM配置表)
├── id: UUID
├── user_id: UUID → users.id
├── name: string
├── provider: enum
├── model_name: string
├── api_key: string (加密)
├── temperature: float
└── max_tokens: int

assistant_configs (助手配置表)
├── id: UUID
├── user_id: UUID → users.id
├── name: string
├── llm_config_id: UUID → llm_configs.id
├── system_prompt: text
├── enable_knowledge_base: bool
├── knowledge_base_ids: json
├── enable_datasource: bool
├── datasource_ids: json
├── enable_interface: bool
├── interface_ids: json
└── auto_route: bool

conversations (对话表)
├── id: UUID
├── user_id: UUID → users.id
├── assistant_id: UUID → assistant_configs.id
├── title: string
├── system_prompt: text
├── model: string
├── temperature: float
└── max_tokens: int

messages (消息表)
├── id: UUID
├── conversation_id: UUID → conversations.id
├── role: enum (user/assistant/system)
├── content: text
└── created_at: datetime

knowledge_bases (知识库表)
├── id: UUID
├── user_id: UUID → users.id
├── name: string
└── vector_store_config: json

datasources (数据源表)
├── id: UUID
├── user_id: UUID → users.id
├── name: string
├── type: enum
├── config: json
├── usage_doc: text
├── schema_info: json
└── examples: json

custom_interfaces (接口表)
├── id: UUID
├── user_id: UUID → users.id
├── name: string
├── type: enum
├── parameters: json
└── response_schema: json
```

---

## 快速开始

### 1. 环境要求

- Docker & Docker Compose
- Node.js 20.19+
- Python 3.11+

### 2. 启动服务

```bash
# 克隆项目
git clone <repository-url>
cd CoreMind

# 启动Docker服务（PostgreSQL, Redis）
docker compose up -d

# 启动后端
cd backend
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
python main.py

# 启动前端（新终端）
cd frontend
npm install
npm run dev
```

### 3. 访问应用

- 前端: http://localhost:5173
- 后端: http://localhost:8000
- API文档: http://localhost:8000/docs

### 4. 快速体验

1. 注册账号：http://localhost:5173/register
2. 创建LLM配置：`/llm-configs`
3. 创建助手配置：`/assistants`
4. 开始对话：`/chat`

---

## 使用流程

### 标准工作流

```
第一步：配置LLM
  → 访问 /llm-configs
  → 添加模型配置（如GPT-4）
  → 填写API密钥

第二步：准备资源（可选）
  → 上传知识库文档 (/knowledge)
  → 配置数据源 (/datasources)
  → 定义接口 (/interfaces)

第三步：创建助手
  → 访问 /assistants
  → 选择LLM模型
  → 配置功能权限
  → 编写系统提示词

第四步：开始对话
  → 访问 /chat
  → 选择助手
  → 发送消息
```

---

## 功能状态

### ✅ 已完成

- [x] 用户认证系统
- [x] LLM配置管理
- [x] 助手配置管理
- [x] 数据源管理（含使用规范）
- [x] 知识库管理
- [x] 接口管理
- [x] 对话创建（基于助手）
- [x] 消息收发
- [x] 对话历史
- [x] 数据库设计
- [x] API设计
- [x] 前端UI框架

### 🔄 开发中

- [ ] LLM服务集成
- [ ] 智能路由实现
- [ ] 知识库检索集成
- [ ] 数据源查询执行
- [ ] 接口调用执行
- [ ] 流式输出
- [ ] Function Calling

### 📋 计划中

- [ ] 对话模板
- [ ] 消息编辑
- [ ] 对话分享
- [ ] 团队协作
- [ ] 权限管理
- [ ] 成本统计
- [ ] 多模态支持
- [ ] 插件系统

---

## 文档索引

### 用户文档

- [快速开始指南](./README.md)
- [对话助手配置功能说明](./docs/对话助手配置功能说明.md)
- [对话功能快速测试](./docs/对话功能快速测试.md)
- [模型手动输入功能说明](./docs/模型手动输入功能说明.md)
- [使用示例](./docs/使用示例.md)

### 技术文档

- [系统设计文档](./docs/系统设计文档.md)
- [API文档](./docs/API文档.md)
- [部署指南](./docs/部署指南.md)
- [更新日志](./docs/更新日志-对话助手.md)

### 开发文档

- [项目交付清单](./项目交付清单.md)
- [数据库迁移脚本](./backend/scripts/)

---

## 常见问题

### Q1: 如何配置第一个助手？

1. 先创建LLM配置 (`/llm-configs`)
2. 然后创建助手 (`/assistants`)，选择刚创建的LLM
3. 在对话页面 (`/chat`) 创建对话时选择该助手

### Q2: 为什么AI回复是演示数据？

当前版本尚未集成真实的LLM API调用。回复会显示助手配置信息和演示文本。真实LLM集成正在开发中。

### Q3: 如何添加自定义模型？

1. 在LLM配置中选择"自定义"供应商
2. 手动输入模型名称
3. 填写API基础URL和密钥

### Q4: 智能路由是什么？

智能路由是系统自动分析用户问题，决定调用知识库、数据源还是接口的功能。当前为演示版本，完整实现开发中。

### Q5: 如何配置数据源使用规范？

在数据源详情页面填写：
- 使用规范文档：描述如何使用
- 结构信息：数据库schema或API参数
- 使用示例：具体的查询例子

---

## 贡献指南

欢迎贡献代码、报告问题或提出建议！

### 报告问题

请提供：
- 问题描述
- 复现步骤
- 预期行为
- 实际行为
- 环境信息

### 提交代码

1. Fork项目
2. 创建特性分支
3. 提交更改
4. 推送到分支
5. 创建Pull Request

---

## 许可证

MIT License

---

## 联系方式

- 项目仓库: <repository-url>
- 文档: ./docs/
- 问题追踪: <issues-url>

---

**CoreMind - 构建您的专属AI助手平台**

*最后更新：2025-11-12*

